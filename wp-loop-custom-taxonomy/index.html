<!doctype html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"><link rel="canonical" href="https://bradonomics.com/wp-loop-custom-taxonomy/"><title>How To Loop Through a Custom Post Type Taxonomy</title><meta name="description" content="How to create a custom loop for a custom post type and display only a single taxonomy."><meta property="og:url" content="https://bradonomics.com/wp-loop-custom-taxonomy/"><meta property="og:title" content="How To Loop Through a Custom Post Type Taxonomy"><meta property="og:description" content="How to create a custom loop for a custom post type and display only a single taxonomy."><meta property="og:image" content="https://bradonomics.com/images/brad-west-theme-300x225.jpg"><meta name="google-site-verification" content="BQbL7BieqK_q7vMFzbBaByQl40P0CSIuPaYMSEPjEhs"><link rel="alternate" type="application/rss+xml" title="Bradonomics" href="http://feeds.feedburner.com/bradonomics"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Oxygen+Mono|Raleway:400,900"><link rel="stylesheet" href="https://bradonomics.com/css/main.css"></head><body itemscope itemtype="http://schema.org/WebPage"> <!--[if lte IE 9]><p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p><![endif]--><header class="site-header" itemscope itemtype="http://schema.org/WPHeader"><p class="site-title" itemprop="headline"> <a href="/">Brad West</a></p><nav itemscope="itemscope" itemtype="http://schema.org/SiteNavigationElement"> <a class="menu-item" href="/about/">About</a><a class="menu-item" href="/blog/">Blog</a><a class="menu-item" href="/now/">Now</a></nav></header><div class="container"><main class="content"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header class="entry-header"><h1 class="entry-title" itemprop="headline">How To Loop Through a Custom Post Type Taxonomy</h1></header><div class="entry-content" itemprop="articleBody"><p>What follows is a WordPress tutorial about displaying a single category of a custom post type.</p><p>The below example is a job board with a custom taxonomy for role type. In this case there are two types of jobs: Executive and Management. First we’ll create the custom post type, then the custom taxonomy, and finally we’ll write a loop to display only one of the taxonomies.</p><h2 id="creating-the-custom-post-type">Creating the Custom Post Type</h2><p>There is a great site called <a href="https://generatewp.com/">GenerateWP</a> that can help you create <a href="https://generatewp.com/post-type/">custom post types</a>, <a href="https://generatewp.com/taxonomy/">custom taxonomies</a>, <a href="https://generatewp.com/wp_query/">custom loops</a>, or a dozen other things. But here’s how I created my custom “jobs” post type:</p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>

<span class="c1">//* Add Jobs Post Type</span>
<span class="nx">add_action</span><span class="p">(</span> <span class="s1">'init'</span><span class="p">,</span> <span class="s1">'register_jobs_post_type'</span> <span class="p">);</span>
<span class="k">function</span> <span class="nf">register_jobs_post_type</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">register_post_type</span><span class="p">(</span> <span class="s1">'jobs'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
      <span class="s1">'labels'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'Jobs'</span><span class="p">,</span>
        <span class="s1">'singular_name'</span> <span class="o">=&gt;</span> <span class="s1">'Job'</span><span class="p">,</span>
      <span class="p">),</span>
      <span class="s1">'supports'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'title'</span><span class="p">,</span>
        <span class="s1">'editor'</span><span class="p">,</span>
        <span class="s1">'genesis-seo'</span><span class="p">,</span> <span class="c1">// Adds SEO Settings for Genesis Framework</span>
        <span class="s1">'genesis-layouts'</span><span class="p">,</span> <span class="c1">// Adds Layout Settings for Genesis Framework</span>
        <span class="s1">'genesis-cpt-archives-settings'</span><span class="p">,</span> <span class="c1">// Adds Taxonomies for Genesis Framework</span>
      <span class="p">),</span>
      <span class="s1">'public'</span> <span class="o">=&gt;</span> <span class="kc">true</span><span class="p">,</span>
      <span class="s1">'has_archive'</span> <span class="o">=&gt;</span> <span class="kc">true</span><span class="p">,</span>
      <span class="s1">'show_in_menu'</span> <span class="o">=&gt;</span> <span class="kc">true</span><span class="p">,</span>
      <span class="s1">'exclude_from_search'</span> <span class="o">=&gt;</span> <span class="kc">false</span><span class="p">,</span>
      <span class="s1">'rewrite'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span> <span class="s1">'slug'</span> <span class="o">=&gt;</span> <span class="s1">'job'</span> <span class="p">),</span>
      <span class="s1">'query_var'</span> <span class="o">=&gt;</span> <span class="kc">true</span><span class="p">,</span>
      <span class="s1">'menu_position'</span> <span class="o">=&gt;</span> <span class="mi">6</span><span class="p">,</span>
      <span class="s1">'menu_icon'</span> <span class="o">=&gt;</span> <span class="s1">'dashicons-clipboard'</span><span class="p">,</span>
    <span class="p">)</span>
  <span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div><p>Now that you have the code, you <em>could</em> place it in your functions.php file, but in an effort to keep that file short and readable I create a directory in my child themes called “inc” (short for includes). Inside that directory I’ll add a file called custom-post-types.php. Then I’ll call custom-post-types.php in the functions file like this:</p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>

<span class="c1">//* Include Custom Post Types</span>
<span class="k">include_once</span><span class="p">(</span> <span class="nx">get_stylesheet_directory</span><span class="p">()</span> <span class="o">.</span> <span class="s1">'/inc/custom-post-types.php'</span> <span class="p">);</span>
</code></pre></div></div><h2 id="creating-the-custom-taxonomy">Creating the Custom Taxonomy</h2><p>By default WordPress comes with categories and tags. In the case of this job board the client was already using the default taxonomies on his blog and I didn’t want to confuse matters by using the same taxonomies inside the job board. Here is the code I used to create a new taxonomy that would keep separate the Executive and Management roles:</p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>

<span class="c1">//* Add Role Taxonomy for Jobs Post Type</span>
<span class="nx">add_action</span><span class="p">(</span> <span class="s1">'init'</span><span class="p">,</span> <span class="s1">'rsi_job_role_type_taxonomy'</span><span class="p">,</span> <span class="mi">0</span> <span class="p">);</span>
<span class="k">function</span> <span class="nf">rsi_job_role_type_taxonomy</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">register_taxonomy</span><span class="p">(</span> <span class="s1">'job_role'</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span> <span class="s1">'jobs'</span> <span class="p">),</span> <span class="k">array</span><span class="p">(</span>
      <span class="s1">'labels'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="nx">_x</span><span class="p">(</span> <span class="s1">'Role Type'</span><span class="p">,</span> <span class="s1">'taxonomy general name'</span> <span class="p">),</span>
        <span class="s1">'singular_name'</span> <span class="o">=&gt;</span> <span class="nx">_x</span><span class="p">(</span> <span class="s1">'Role Type'</span><span class="p">,</span> <span class="s1">'taxonomy singular name'</span> <span class="p">),</span>
        <span class="s1">'search_items'</span> <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Search Role Types'</span> <span class="p">),</span>
        <span class="s1">'all_items'</span> <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'All Role Types'</span> <span class="p">),</span>
        <span class="s1">'parent_item'</span> <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Parent Role Type'</span> <span class="p">),</span>
        <span class="s1">'parent_item_colon'</span> <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Parent Role Type:'</span> <span class="p">),</span>
        <span class="s1">'update_item'</span> <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Update Role Type'</span> <span class="p">),</span>
        <span class="s1">'edit_item'</span> <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Edit Role Type'</span> <span class="p">),</span>
        <span class="s1">'add_new_item'</span> <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Add New Role Type'</span> <span class="p">),</span>
        <span class="s1">'new_item_name'</span> <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'New Role Type'</span> <span class="p">),</span>
        <span class="s1">'menu_name'</span> <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">'Role Types'</span> <span class="p">),</span>
      <span class="p">),</span>
      <span class="s1">'rewrite'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">'slug'</span> <span class="o">=&gt;</span> <span class="s1">'role-type'</span>
      <span class="p">),</span>
      <span class="s1">'hierarchical'</span> <span class="o">=&gt;</span> <span class="kc">true</span><span class="p">,</span>
    <span class="p">)</span>
  <span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div><p>I add this code in its own file in the /inc directory just as I did with the custom post types. In this case I called the file custom-taxonomies.php and call it in the functions file like so:</p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>

<span class="c1">//* Include Custom Taxonomies</span>
<span class="k">include_once</span><span class="p">(</span> <span class="nx">get_stylesheet_directory</span><span class="p">()</span> <span class="o">.</span> <span class="s1">'/inc/custom-taxonomies.php'</span> <span class="p">);</span>
</code></pre></div></div><p><strong>NOTE:</strong> Including custom post types or custom taxonomies in your child theme’s /inc directory is something you’ll need to think about before you start coding. If you do include them in the child theme and the theme is changed later, that custom data will no longer be available. It is often better to add custom data like this as a plugin. If that data is added as a plugin it will be available no matter what happens with the theme in the future.</p><h2 id="loop-trough-single-taxonomy-of-a-custom-post-type">Loop Trough Single Taxonomy of a Custom Post Type</h2><p>Now that the taxonomy is built in the backend we can add the Executive and Management roles in the dashboard. Once WordPress knows they exist we can loop through them. In this case I’d built a custom template and used the loop below to call only the Executive role on that page.</p><div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>

<span class="c1">//* The Query</span>
<span class="nv">$exec_query</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WP_Query</span><span class="p">(</span> <span class="k">array</span> <span class="p">(</span>
  <span class="s1">'post_type'</span> <span class="o">=&gt;</span> <span class="s1">'jobs'</span><span class="p">,</span>
  <span class="s1">'job_role'</span>  <span class="o">=&gt;</span> <span class="s1">'executive'</span><span class="p">,</span>
  <span class="s1">'posts_per_page'</span> <span class="o">=&gt;</span> <span class="mi">4</span>
<span class="p">)</span> <span class="p">);</span>

<span class="c1">//* The Loop</span>
<span class="k">if</span> <span class="p">(</span> <span class="nv">$exec_query</span><span class="o">-&gt;</span><span class="na">have_posts</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span> <span class="cp">?&gt;</span>

      <span class="nt">&lt;h3</span> <span class="na">class=</span><span class="s">"title"</span><span class="nt">&gt;</span>Executive<span class="nt">&lt;/h3&gt;</span>

      <span class="nt">&lt;ul&gt;</span> <span class="cp">&lt;?php</span>

    <span class="k">while</span> <span class="p">(</span> <span class="nv">$exec_query</span><span class="o">-&gt;</span><span class="na">have_posts</span><span class="p">()</span> <span class="p">)</span><span class="o">:</span> <span class="nv">$exec_query</span><span class="o">-&gt;</span><span class="na">the_post</span><span class="p">();</span> <span class="cp">?&gt;</span>

        <span class="nt">&lt;li&gt;</span>
          <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"</span><span class="cp">&lt;?php</span> <span class="nx">the_permalink</span><span class="p">();</span> <span class="cp">?&gt;</span><span class="s">"</span><span class="nt">&gt;</span><span class="cp">&lt;?php</span> <span class="nx">the_title</span><span class="p">();</span> <span class="cp">?&gt;</span><span class="nt">&lt;/a&gt;</span>
        <span class="nt">&lt;/li&gt;</span> <span class="cp">&lt;?php</span>

    <span class="k">endwhile</span><span class="p">;</span> <span class="cp">?&gt;</span>

      <span class="nt">&lt;/ul&gt;</span> <span class="cp">&lt;?php</span>

    <span class="c1">//* Restore original Post Data</span>
    <span class="nx">wp_reset_postdata</span><span class="p">();</span>

<span class="p">}</span>
</code></pre></div></div><p>If you want to see the live code for this project, the theme files are <a href="https://github.com/bradonomics/rsi-international/">available on GitHub</a> and the display of this loop can be seen on <a href="http://rsiinternational.asia/candidate/#available-positions">the client’s site</a>.</p></div><footer class="entry-footer"><p class="entry-meta"> <span class="entry-time">This article was published on <time class="entry-time" itemprop="datePublished" datetime="2016-04-01T00:00:00-05:00">April 1, 2016</time></span> <span class="entry-category">In category: <a href="/category/general-geekery" rel="category tag">General Geekery</a></span></p><hr><p class="after-post-title">Questions / Comments</p><p class="after-post">I post ideas online to improve them. If you found this article interesting, found errors, or just want to discuss the ideas herein, please get in touch.</p></footer></article></main></div><footer class="site-footer" itemscope itemtype="http://schema.org/WPFooter"><p class="copyright">Copyright &copy; 2018</p><p class="contact">brad@bradonomics.com</p></footer></body></html>
